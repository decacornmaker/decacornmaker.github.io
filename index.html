<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>무료 QR 코드 생성기</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:0; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 16px; }
    .ad {
      position: sticky; top: 0; z-index: 10;
      background: #fff; border-bottom: 1px solid #eee;
      padding: 10px; text-align: center; min-height: 90px;
    }
    .card { border:1px solid #eee; border-radius: 12px; padding: 16px; margin-top: 14px; }
    input, button { width:100%; padding: 12px; font-size: 16px; box-sizing: border-box; }
    button { margin-top: 10px; cursor: pointer; }
    #out { margin-top: 14px; text-align: center; }
    .hint { color:#666; font-size: 14px; line-height: 1.5; }

    /* 생성중 오버레이 (광고 아님) */
    #overlay {
      position: fixed; inset: 0; display: none;
      align-items: center; justify-content: center;
      background: rgba(0,0,0,0.75);
      z-index: 99999; color: #fff;
    }
    .spinner {
      width: 36px; height: 36px;
      border: 4px solid rgba(255,255,255,0.35);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.9s linear infinite;
      margin: 0 auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    a.btn {
      display:inline-block; margin-top: 10px; padding: 10px 12px;
      border: 1px solid #ddd; border-radius: 10px; text-decoration: none; color:#111;
    }
  </style>
</head>
<body>

  <!-- 광고 영역: 여기만 나중에 AdSense 코드로 교체 -->
  <div class="ad">
    <div class="hint">광고 영역</div>
    <!-- AdSense 승인 후, 이 아래에 광고 스크립트/광고 단위를 넣으세요 -->
  </div>

  <div class="wrap">
    <div class="card">
      <div class="hint">
        본 무료 서비스는 광고로 운영됩니다.<br/>
        입력한 링크는 서버에 저장되지 않으며, QR 코드는 브라우저에서 생성됩니다.
      </div>
    </div>

    <div class="card">
      <input id="url" placeholder="https://example.com" autocomplete="off" />
      <button id="go">QR 만들기</button>
      <div id="out"></div>
    </div>
  </div>

  <!-- 생성중 전체화면 오버레이 (광고 아님) -->
  <div id="overlay">
    <div style="text-align:center;">
      <div style="font-size:18px; margin-bottom:12px;">QR 생성 중…</div>
      <div class="spinner"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script>
    const $ = (id) => document.getElementById(id);
    const overlay = $("overlay");

    function isValidUrl(s) {
      try {
        const u = new URL(s);
        return u.protocol === "http:" || u.protocol === "https:";
      } catch { return false; }
    }

    $("go").addEventListener("click", async () => {
      const url = $("url").value.trim();
      if (!isValidUrl(url)) {
        alert("http:// 또는 https:// 로 시작하는 URL을 입력하세요.");
        return;
      }

      overlay.style.display = "flex";

      // UX용 최소 표시 시간 (광고 강제 목적 X)
      const minDelay = new Promise(r => setTimeout(r, 1200));

      const out = $("out");
      out.innerHTML = "";

      const canvas = document.createElement("canvas");
      const makeQR = QRCode.toCanvas(canvas, url, {
        errorCorrectionLevel: "Q", // ERROR_CORRECT_Q
        margin: 2,
        scale: 8
      });

      await Promise.all([minDelay, makeQR]);

      out.appendChild(canvas);

      // 다운로드 버튼
      const a = document.createElement("a");
      a.className = "btn";
      a.textContent = "PNG로 다운로드";
      a.href = canvas.toDataURL("image/png");
      a.download = "qr.png";
      out.appendChild(document.createElement("div"));
      out.appendChild(a);

      overlay.style.display = "none";
    });
  </script>
</body>
</html>
